{"version":3,"sources":["../src/checktable.js"],"names":["checkall","document","querySelector","checkboxes","querySelectorAll","onclick","forEach","c","checked","action","a","e","preventDefault","data","k","v","getAttribute","M","cfg","sesskey","push","component","done","s","Notification","confirm","redirectPost","window","location","fail","exception","value","url","form","createElement","body","appendChild","method","pair","input","type","name","submit"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript controller for checkboxed table.\n *\n * @package tool_cleanupusers\n * @copyright  2021 Justus Dieckmann WWU\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport {get_strings as getStrings} from 'core/str';\nimport Notification from \"core/notification\";\n\nfunction redirectPost(url, data) {\n    const form = document.createElement('form');\n    document.body.appendChild(form);\n    form.method = 'post';\n    form.action = url;\n    for (const pair of data) {\n        const input = document.createElement('input');\n        input.type = 'hidden';\n        input.name = pair.k;\n        input.value = pair.v;\n        form.appendChild(input);\n    }\n    form.submit();\n}\n\nexport function init() {\n    const checkall = document.querySelector('input[name=\"tool_cleanupusers-checkall\"]');\n    if (!checkall) {\n        return;\n    }\n    const checkboxes = document.querySelectorAll('input[name=\"tool_cleanupusers-check\"]');\n    checkall.onclick = () => {\n        checkboxes.forEach((c) => {\n            c.checked = checkall.checked;\n        });\n    };\n    const action = document.querySelectorAll('*[data-cleanupusers-action]');\n    action.forEach((a) => {\n        a.onclick = (e) => {\n            e.preventDefault();\n            let data = [\n                {k: 'a', v: a.getAttribute('data-cleanupusers-action')},\n                {k: 'sesskey', v: M.cfg.sesskey}\n            ];\n            if (a.getAttribute('data-cleanupusers-forall') === '1') {\n                data.push({k: 'all', v: '1'});\n\n                getStrings([\n                    {'key' : 'warning'},\n                    {'key' : 'forallwarning', component : 'tool_cleanupusers'},\n                    {'key' : 'yes'},\n                    {'key' : 'no'},\n                ]).done(function(s) {\n                        Notification.confirm(s[0], s[1], s[2], s[3], function() {\n                            redirectPost(window.location, data);\n                        });\n                    }\n                ).fail(Notification.exception);\n            } else  {\n                checkboxes.forEach((c) => {\n                    if (c.checked) {\n                        data.push({k: 'ids[]', v: c.value});\n                    }\n                });\n                redirectPost(window.location, data);\n            }\n        };\n    });\n}"],"file":"checktable.min.js"}